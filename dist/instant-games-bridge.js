(()=>{var t={258:t=>{!function(e){t.exports=e;var i={on:function(t,e){return a(this,t).push(e),this},once:function(t,e){var i=this;return r.originalListener=e,a(i,t).push(r),i;function r(){s.call(i,t,r),e.apply(this,arguments)}},off:s,emit:function(t,e){var i=this,r=a(i,t,!0);if(!r)return!1;var s=arguments.length;if(1===s)r.forEach(n);else if(2===s)r.forEach(h);else{var o=Array.prototype.slice.call(arguments,1);r.forEach(l)}return!!r.length;function n(t){t.call(i)}function h(t){t.call(i,e)}function l(t){t.apply(i,o)}}};function r(t){for(var e in i)t[e]=i[e];return t}function s(t,e){var i,r=this;if(arguments.length){if(e){if(i=a(r,t,!0)){if(!(i=i.filter(o)).length)return s.call(r,t);r.listeners[t]=i}}else if((i=r.listeners)&&(delete i[t],!Object.keys(i).length))return s.call(r)}else delete r.listeners;return r;function o(t){return t!==e&&t.originalListener!==e}}function a(t,e,i){if(!i||t.listeners){var r=t.listeners||(t.listeners={});return r[e]||(r[e]=[])}}r(e.prototype),e.mixin=r}((function t(){if(!(this instanceof t))return new t}))}},e={};function i(r){var s=e[r];if(void 0!==s)return s.exports;var a=e[r]={exports:{}};return t[r](a,a.exports,i),a.exports}i.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return i.d(e,{a:e}),e},i.d=(t,e)=>{for(var r in e)i.o(e,r)&&!i.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:e[r]})},i.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),(()=>{"use strict";var t=i(258),e=i.n(t);const r="created",s="completed";class a{get state(){return this.#t}#e=0;#i=0;#t=r;#r=0;constructor(t){this.#e=t}start(){switch(this.#t){case r:case s:this.#i=this.#e,this.#s("started"),this.#r=setInterval((()=>{this.#i-=1,this.emit("time_left_changed",this.#i),this.#i<=0&&(this.#a(),this.#s(s))}),1e3)}}stop(){this.#a(),this.#s("stopped")}#s(t){this.#t=t,this.emit("state_changed",this.#t)}#a(){this.#i=0,clearInterval(this.#r)}}e().mixin(a.prototype);const o=a,n="interstitial_state_changed",h="rewarded_state_changed",l="opened",d="closed",m="failed",c="opened",w="closed",u="failed",D="rewarded";class g{get interstitialState(){return this.#o.interstitialState}get rewardedState(){return this.#o.rewardedState}#o;#n;#h=60;constructor(t){this.#o=t,this.#o.on(n,(t=>this.emit(n,t))),this.#o.on(h,(t=>this.emit(h,t)))}setMinimumDelayBetweenInterstitial(t){this.#h=t,this.#n&&(this.#n.stop(),this.#l())}showInterstitial(t){let e=!1;return t&&(e=t.ignoreDelay),this.#n&&this.#n.state!==s&&!e?Promise.reject("The minimum delay between interstitials has not passed"):(this.#h>0&&this.#l(),this.#o.showInterstitial())}showRewarded(){return this.#o.showRewarded()}#l(){this.#n=new o(this.#h),this.#n.start()}}e().mixin(g.prototype);const P=g,p="game_data";class S{get id(){return"mock"}get sdk(){return{}}get interstitialState(){return this.#d}get rewardedState(){return this.#m}#d;#m;#c;initialize(){return Promise.resolve()}showInterstitial(){return new Promise((t=>{t(),this.#w(l),this.#w(d)}))}showRewarded(){return new Promise((t=>{t(),this.#u(c),this.#u(D),this.#u(w)}))}getGameData(t){return new Promise((e=>{if(this.#c)void 0===this.#c[t]?e(null):e(this.#c[t]);else{try{let t=localStorage.getItem(p);t&&(this.#c=JSON.parse(t))}catch(t){}void 0===this.#c[t]?e(null):e(this.#c[t])}}))}setGameData(t,e){return this.#c||(this.#c={}),this.#c[t]=e,new Promise((t=>{try{localStorage.setItem(p,JSON.stringify(this.#c))}catch(t){}t()}))}#w(t){this.#d=t,this.emit(n,this.#d)}#u(t){this.#m=t,this.emit(h,this.#m)}}e().mixin(S.prototype);const f=S,v=class{#D;#g;#P;get promise(){return this.#D}constructor(){this.#D=new Promise(((t,e)=>{this.#g=t,this.#P=e}))}resolve(){this.#g()}reject(){this.#P()}},I=function(t){return new Promise((e=>{let i=document.createElement("script");i.src=t,i.addEventListener("load",e),document.head.appendChild(i)}))};class y{get id(){return"vk"}get sdk(){return this.#p}get interstitialState(){return this.#d}get rewardedState(){return this.#m}#p;#S;#f;#d;#m;#v;#I;initialize(){return this.#S?Promise.resolve():(this.#f||(this.#f=new v,I("https://unpkg.com/@vkontakte/vk-bridge/dist/browser.min.js").then((()=>{this.#p=window.vkBridge,this.#p.send("VKWebAppInit").then((()=>{this.#S=!0,this.#f&&(this.#f.resolve(),this.#f=null)}))}))),this.#f.promise)}showInterstitial(){return this.#v||(this.#v=new v,this.#p.send("VKWebAppShowNativeAds",{ad_format:"preloader"}).then((t=>{t.result?(this.#v&&(this.#v.resolve(),this.#v=null),this.#w(l),this.#w(d)):(this.#v&&(this.#v.reject(),this.#v=null),this.#w(m))})).catch((t=>{this.#v&&(this.#v.reject(t),this.#v=null),this.#w(m)}))),this.#v.promise}showRewarded(){return this.#I||(this.#I=new v,this.#p.send("VKWebAppShowNativeAds",{ad_format:"reward",use_waterfall:!0}).then((t=>{t.result?(this.#I&&(this.#I.resolve(),this.#I=null),this.#u(c),this.#u(D),this.#u(w)):(this.#I&&(this.#I.reject(),this.#I=null),this.#u(u))})).catch((t=>{this.#I&&(this.#I.reject(t),this.#I=null),this.#u(u)}))),this.#I.promise}getGameData(t){return new Promise((e=>{this.#p.send("VKWebAppStorageGet",{keys:[t]}).then((t=>{if(""===t.keys[0].value)return void e(null);let i;try{i=JSON.parse(t.keys[0].value)}catch(e){i=t.keys[0].value}e(i)})).catch((()=>{e(null)}))}))}setGameData(t,e){return new Promise((i=>{let r={key:t,value:e};"string"!=typeof e&&(r.value=JSON.stringify(e)),this.#p.send("VKWebAppStorageSet",r).then((()=>{i()}))}))}#w(t){this.#d!==t&&(this.#d=t,this.emit(n,this.#d))}#u(t){this.#m!==t&&(this.#m=t,this.emit(h,this.#m))}}e().mixin(y.prototype);const R=y,k="game_data";class z{get id(){return"yandex"}get sdk(){return this.#p}get interstitialState(){return this.#d}get rewardedState(){return this.#m}#p;#S;#f;#d;#m;#v;#I;#y;#R;#c;initialize(){return this.#S?Promise.resolve():(this.#f||(this.#f=new v,I("https://yandex.ru/games/sdk/v2").then((()=>{window.YaGames.init().then((t=>{this.#p=t,this.#p.getPlayer({scopes:!1}).then((t=>{this.#y=t,this.#S=!0,this.#f&&(this.#f.resolve(),this.#f=null)})).catch((t=>{this.#p.getStorage().then((t=>{this.#R=t,this.#S=!0,this.#f&&(this.#f.resolve(),this.#f=null)}))}))}))}))),this.#f.promise)}showInterstitial(){return this.#d===l?Promise.reject():(this.#v||(this.#v=new v,this.#p.adv.showFullscreenAdv({callbacks:{onOpen:()=>{this.#v&&(this.#v.resolve(),this.#v=null),this.#w(l)},onClose:t=>{t?this.#w(d):(this.#v&&(this.#v.reject(),this.#v=null),this.#w(m))}}})),this.#v.promise)}showRewarded(){return this.#m===c||this.#m===D?Promise.reject():(this.#I||(this.#I=new v,this.#p.adv.showRewardedVideo({callbacks:{onOpen:()=>{this.#I&&(this.#I.resolve(),this.#I=null),this.#u(c)},onRewarded:()=>{this.#u(D)},onClose:()=>{this.#u(w)},onError:t=>{this.#I&&(this.#I.reject(t),this.#I=null),this.#u(u)}}})),this.#I.promise)}getGameData(t){return new Promise((e=>{if(this.#c)void 0===this.#c[t]?e(null):e(this.#c[t]);else if(this.#y)this.#y.getData().then((i=>{this.#c=i,void 0===this.#c[t]?e(null):e(this.#c[t])})).catch((()=>{e(null)}));else{if(this.#R){let t=this.#R.getItem(k);t&&(this.#c=JSON.parse(t))}else try{let t=localStorage.getItem(k);t&&(this.#c=JSON.parse(t))}catch(t){}void 0===this.#c[t]?e(null):e(this.#c[t])}}))}setGameData(t,e){return this.#c||(this.#c={}),this.#c[t]=e,new Promise((t=>{if(this.#y)this.#y.setData(this.#c).then((()=>{t()}));else if(this.#R)this.#R.setItem(k,JSON.stringify(this.#c)),t();else{try{localStorage.setItem(k,JSON.stringify(this.#c))}catch(t){}t()}}))}#w(t){this.#d!==t&&(this.#d=t,this.emit(n,this.#d))}#u(t){this.#m!==t&&(this.#m=t,this.emit(h,this.#m))}}e().mixin(z.prototype);const j=z;class _{static get version(){return"1.0.0"}get isInitialized(){return this.#S}get platform(){return this.#k}get advertisement(){return this.#z}get game(){return this.#j}#S=!1;#k;#z;#j;initialize(){return this.#S?Promise.resolve():new Promise((t=>{this.#_(),this.#k.initialize().then((()=>{this.#z=new P(this.#k),this.#j=new class{#o;constructor(t){this.#o=t}getData(t){return this.#o.getGameData(t)}setData(t,e){return this.#o.setGameData(t,e)}}(this.#k),this.#S=!0,console.log("%c InstantGamesBridge v."+_.version+" initialized. ","background: #01A5DA; color: white"),t()}))}))}#_(){let t=new URL(window.location.href);t.hostname.includes("games.s3.yandex.net")?this.#k=new j:t.searchParams.has("api_id")&&t.searchParams.has("viewer_id")&&t.searchParams.has("auth_key")?this.#k=new R:this.#k=new f}}const b=_;window.instantGamesBridge=new b})()})();